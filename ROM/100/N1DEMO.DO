1 '(c) 1986 Polar Engineering and Consulting
5 SCREEN0
10 CALL63013,8 'must check for RAM Disk first thing!
15 S$="" 'define string so varptr won't cause an ?FC error
100 REM Command input loop
105 C$="":INPUT"[M]enu, [F]iles or command #";C$
110 IF C$="" THEN MENU
115 F=VAL(C$):C$=LEFT$(C$,1)
120 IF C$="M" OR C$="m" THEN MENU
125 IF C$="F" OR C$="f" THEN GOSUB10000:GOTO100
130 IF F<8 OR F>37 THEN BEEP:GOTO100
135 ONF-7GOSUB800,900,1000,1100,1200,1300,1400,1500,1600,1700,1800,1900,2000,2100,2200,2300,2400,2500,2600,2700,2800,2900,3000,3100,3200,3300,3400,3500,3600,3700
140 GOTO100
800 REM Is the RAM Disk formatted?
805 PRINT"RAM Disk formatted?"
810 PRINT"Error #200:no RAM bank"
815 PRINT"      #201:not formatted"
820 CALL63013,8
825 RETURN
900 REM Format the RAM Disk
905 PRINT"Format RAM Disk"
910 CALL63013,9
915 PRINT"RAM Disk is now formatted"
920 RETURN
1000 REM Find next visible RAM Disk directory entry
1005 PRINT"Find next visible file"
1010 FT=192:INPUT"File type (128=BA, 160=CO, 192=DO)";FT
1015 POKE-1,FT
1020 CALL63013,10,VARPTR(S$)
1025 IF PEEK(-1)=0 THEN PRINT"No more files":RETURN
1030 PRINT"Next visible file: "S$
1035 RETURN
1100 REM --
1105 PRINT"Undefined"
1110 RETURN
1200 REM Reset directory search
1205 PRINT"Reset directory search"
1210 CALL63013,12
1215 RETURN
1300 REM Set filnam block with filename in string
1305 PRINT"Set filnam block"
1310 AF$="":INPUT"File name";AF$:IF AF$=""THEN RETURN
1315 CALL63013,13,VARPTR(AF$)
1320 RETURN
1400 REM Amount of RAM Disk space free
1405 PRINT"Amount of RAM Disk space free"
1410 CALL63013,14
1415 FS!=(PEEK(64728)+PEEK(64729)*256)*256
1420 PRINTFS!"bytes free"
1425 RETURN
1500 REM --
1505 PRINT"Undefined"
1510 RETURN
1600 REM --
1605 PRINT"Undefined"
1610 RETURN
1700 REM --
1705 PRINT"Undefined"
1710 RETURN
1800 REM Find the next directory entry
1805 PRINT"Find next file"
1810 FT=192:INPUT"File type (128=BA, 160=CO, 192=DO)";FT
1815 POKE-1,FT
1820 CALL63013,18,VARPTR(S$)
1825 IF PEEK(-1)=0 THEN PRINT"No more files":RETURN
1830 PRINT"Next file: "S$
1835 RETURN
1900 REM --
1905 PRINT"Undefined"
1910 RETURN
2000 REM Edit a RAM Disk file
2005 PRINT"Edit a file"
2010 RF$="":INPUT"File name";RF$:IF RF$="" THEN RETURN
2015 LETA=A:CALL63013,20,VARPTR(RF$)
2020 IF PEEK(-1)=0 THEN PRINT"File not found":RETURN
2025 GOTO100 (EDIT CLEARS THE GOSUB/FORLOOP STACK!)
2100 REM Copy a RAM Disk file
2105 PRINT"Copy a file"
2110 RF$="":INPUT"From file name";RF$:IF RF$="" THEN RETURN
2115 AF$=RF$:INPUT"To file name";AF$
2120 CALL63013,13,VARPTR(AF$)
2125 CALL63013,21,VARPTR(RF$)
2130 IF PEEK(-1)=0 THEN PRINT"Copy failed"
2135 RETURN
2200 REM Run a RAM Disk file (will not return to this BASIC program)
2205 PRINT"Run a file"
2210 RF$="":INPUT"From file name";RF$:IF RF$="" THEN RETURN
2215 AF$=RF$:INPUT"As file name";AF$
2220 CALL63013,13,VARPTR(AF$)
2225 CALL63013,22,VARPTR(RF$)
2230 IF PEEK(-1)=0 THEN PRINT"Run failed"
2235 RETURN
2300 REM Load a RAM Disk file
2305 PRINT"Load a file"
2310 RF$="":INPUT"From file name";RF$:IF RF$="" THEN RETURN
2315 AF$=RF$:INPUT"To file name";AF$
2320 CALL63013,13,VARPTR(AF$)
2325 CALL63013,23,VARPTR(RF$)
2330 IF PEEK(-1)=0 THEN PRINT"Load failed"
2335 RETURN
2400 REM Save a RAM Disk file
2405 PRINT"Save a file"
2410 AF$="":INPUT"From file name";AF$:IF AF$="" THEN RETURN
2415 RF$=AF$:INPUT"To file name";RF$
2420 CALL63013,13,VARPTR(AF$)
2425 CALL63013,24,VARPTR(RF$)
2430 IF PEEK(-1)=0 THEN PRINT"Save failed"
2435 RETURN
2500 REM name a RAM Disk file
2505 PRINT"Rename a file"
2510 RF$="":INPUT"Old file name";RF$:IF RF$="" THEN RETURN
2515 AF$=RF$:INPUT"New file name";AF$
2520 CALL63013,13,VARPTR(AF$)
2525 CALL63013,25,VARPTR(RF$)
2530 IF PEEK(-1)=0 THEN PRINT"Name failed"
2535 RETURN
2600 REM delete a RAM Disk file
2605 PRINT"Delete a file"
2610 RF$="":INPUT"File name";RF$:IF RF$="" THEN RETURN
2615 CALL63013,26,VARPTR(RF$)
2620 IF PEEK(-1)=0 THEN PRINT"File not found"
2625 RETURN
2700 REM exist? a RAM Disk file
2705 PRINT"File exist?"
2710 RF$="":INPUT"File name";RF$:IF RF$="" THEN RETURN
2715 CALL63013,27,VARPTR(RF$)
2720 IF PEEK(-1)=0 THEN PRINT"File not found":RETURN
2725 PRINT"File type:"PEEK(-1)
2730 L=PEEK(64728)+PEEK(64729)*256
2735 PRINT"Length:"L
2740 RETURN
2800 REM exist? a main RAM file
2805 PRINT"Main RAM file exist?"
2810 AF$="":INPUT"File name";AF$:IF AF$="" THEN RETURN
2815 CALL63013,28,VARPTR(AF$)
2820 IF PEEK(-1)=0 THEN PRINT"Main RAM file not found":RETURN
2825 PRINT"File type:"PEEK(-1)
2830 L=PEEK(64728)+PEEK(64729)*256
2835 PRINT"Length:"L
2840 RETURN
2900 REM Make a file visible
2905 PRINT"Make a file visible"
2910 RF$="":INPUT"File name";RF$:IF RF$="" THEN RETURN
2915 CALL63013,29,VARPTR(RF$)
2920 IF PEEK(-1)=0 THEN PRINT"File not found"
2925 PRINT"File is visible now"
2930 RETURN
3000 REM --
3005 PRINT"Undefined"
3010 RETURN
3100 REM --
3105 PRINT"Undefined"
3110 RETURN
3200 REM --
3205 PRINT"Undefined"
3210 RETURN
3300 REM --
3305 PRINT"Undefined"
3310 RETURN
3400 REM --
3405 PRINT"Undefined"
3410 RETURN
3500 REM --
3505 PRINT"Undefined"
3510 RETURN
3600 REM --
3605 PRINT"Undefined"
3610 RETURN
3700 REM Make a file invisible
3705 PRINT"Make a file invisible"
3710 RF$="":INPUT"File name";RF$:IF RF$="" THEN RETURN
3715 CALL63013,37,VARPTR(RF$)
3720 IF PEEK(-1)=0 THEN PRINT"File not found":RETURN
3725 PRINT"File is invisible now"
3730 RETURN
10000 REM Ram Disk directory
10005 PRINT"RAM Disk files:"
10010 POKE-1,128:GOSUB11000
10015 POKE-1,160:GOSUB11000
10020 POKE-1,192:GOSUB11000
10023 CALL63013,12
10025 IF POS(0)>1 THEN PRINT
10030 GOTO 1400 'print free space message
11000 REM Ram Disk next file
11005 CALL63013,10,VARPTR(S$)
11010 IF PEEK(-1)=0 THEN RETURN
11030 PRINTS$"  ";
11035 GOTO11000
